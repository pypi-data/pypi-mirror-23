
/* reset requirejs definitions so that people who
   put requirejs in legacy compilation do not get errors */
var _old_define = define;
var _old_require = require;
define = undefined;
require = undefined;
try{

/* resource: ++resource++plone.app.discussion.javascripts/comments.js */
if(require===undefined)require=function(reqs,torun){'use strict';return torun(window.jQuery);};require(['jquery'],function($){'use strict';$.createReplyForm=function(comment_div){var comment_id=comment_div.attr('id');var reply_button=comment_div.find('.reply-to-comment-button');var reply_div=$('#commenting').clone(true);reply_div.find('#formfield-form-widgets-captcha').find('script').remove();reply_div.appendTo(comment_div).css('display','none');reply_div.removeAttr('id');$(reply_button).css('display','none');var reply_form=reply_div.find('form');reply_form.find('#formfield-form-widgets-comment-text').attr('id','formfield-form-widgets-new-textarea'+comment_id);reply_form.find('#form-widgets-comment-text').attr('id','form-widgets-new-textarea'+comment_id);reply_form.find('input[name="form.widgets.in_reply_to"]').val(comment_id);var cancel_reply_button=reply_div.find('.cancelreplytocomment');cancel_reply_button.attr('id',comment_id);reply_form.find('input[name="form.buttons.cancel"]').css('display','inline');reply_div.slideDown('slow');cancel_reply_button.css('display','inline');};$.clearForm=function(form_div){form_div.find('.error').removeClass('error');form_div.find('.fieldErrorBox').remove();form_div.find('input[type="text"]').attr('value','');form_div.find('textarea').attr('value','');};$(window).load(function(){var post_comment_div=$('#commenting');var in_reply_to_field=post_comment_div.find('input[name="form.widgets.in_reply_to"]');if(in_reply_to_field.length!==0&&in_reply_to_field.val()!==''){var current_reply_id='#'+in_reply_to_field.val();var current_reply_to_div=$('.discussion').find(current_reply_id);$.createReplyForm(current_reply_to_div);$.clearForm(post_comment_div);}$('.reply-to-comment-button').bind('click',function(e){var comment_div=$(this).parents().filter('.comment');$.createReplyForm(comment_div);$.clearForm(comment_div);});$('#commenting #form-buttons-cancel').bind('click',function(e){e.preventDefault();var reply_to_comment_button=$(this).parents().filter('.comment').find('.reply-to-comment-button');$.reply_to_comment_form=$(this).parents().filter('.reply');$.reply_to_comment_form.slideUp('slow',function(){$(this).remove();});reply_to_comment_button.css('display','inline');});$('input[name="form.button.PublishComment"]').on('click',function(){var trigger=this;var form=$(this).parents('form');var data=$(form).serialize();var form_url=$(form).attr('action');$.ajax({type:'GET',url:form_url,data:data,context:trigger,success:function(msg){form.find('input[name="form.button.PublishComment"]').remove();form.parents('.state-pending').toggleClass('state-pending').toggleClass('state-published');},error:function(msg){return true;}});return false;});if($.fn.prepOverlay)$('form[name="edit"]').prepOverlay({cssclass:'overlay-edit-comment',width:'60%',subtype:'ajax',filter:'#content>*'});$('input[name="form.button.DeleteComment"]').on('click',function(){var trigger=this;var form=$(this).parents('form');var data=$(form).serialize();var form_url=$(form).attr('action');$.ajax({type:'POST',url:form_url,data:data,context:$(trigger).parents('.comment'),success:function(data){var comment=$(this);var clss=comment.attr('class');var treelevel=parseInt(clss[clss.indexOf('replyTreeLevel')+'replyTreeLevel'.length],10);var selector='.replyTreeLevel'+treelevel;for(var i=0;i<treelevel;i++)selector+=', .replyTreeLevel'+i;comment.nextUntil(selector).each(function(){$(this).fadeOut('fast',function(){$(this).remove();});});var parent=comment.prev('[class*="replyTreeLevel'+(treelevel-1)+'"]');parent.find('form[name="delete"]').css('display','inline');$(this).fadeOut('fast',function(){$(this).remove();});},error:function(req,error){return true;}});return false;});$('.reply').find('input[name="form.buttons.reply"]').css('display','none');$('.reply').find('input[name="form.buttons.cancel"]').css('display','none');$('.reply-to-comment-button').removeClass('hide');});});
/* resource: jquery.highlightsearchterms.js */
(function($){var Highlighter,makeSearchKey,makeAddress,defaults;Highlighter=function(options){$.extend(this,options);this.terms=this.cleanTerms(this.terms.length?this.terms:this.getSearchTerms());};Highlighter.prototype={highlight:function(startnode){if(!this.terms.length||!startnode.length)return;var self=this;$.each(this.terms,function(i,term){startnode.find('*:not(textarea)').andSelf().contents().each(function(){if(this.nodeType===3)self.highlightTermInNode(this,term);});});},highlightTermInNode:function(node,word){var c=node.nodeValue,self=this,highlight,ci,index,next;if($(node).parent().hasClass(self.highlightClass))return;highlight=function(content){return $('<span class="'+self.highlightClass+'">&nbsp;</span>').text(content);};ci=self.caseInsensitive;while(c&&(index=(ci?c.toLowerCase():c).indexOf(word))>-1){$(node).before(document.createTextNode(c.substr(0,index))).before(highlight(c.substr(index,word.length))).before(document.createTextNode(c.substr(index+word.length)));next=node.previousSibling;$(node).remove();node=next;c=node.nodeValue;}},queryStringValue:function(uri,regexp){var match,pair;if(uri.indexOf('?')<0)return '';uri=uri.substr(uri.indexOf('?')+1);while(uri.indexOf('=')>=0){uri=uri.replace(/^\&*/,'');pair=uri.split('&',1)[0];uri=uri.substr(pair.length);match=pair.match(regexp);if(match)return decodeURIComponent(match[match.length-1].replace(/\+/g,' '));}return '';},termsFromReferrer:function(){var ref,i,se;ref=$.fn.highlightSearchTerms._test_referrer!==null?$.fn.highlightSearchTerms._test_referrer:document.referrer;if(!ref)return '';for(i=0;i<this.referrers.length;i+=1){se=this.referrers[i];if(ref.match(se.address))return this.queryStringValue(ref,se.key);}return '';},cleanTerms:function(terms){var self=this;return $.unique($.map(terms,function(term){term=$.trim(self.caseInsensitive?term.toLowerCase():term);return(!term||self.filterTerms.test(term))?null:term;}));},getSearchTerms:function(){var terms=[],uri=$.fn.highlightSearchTerms._test_location!==null?$.fn.highlightSearchTerms._test_location:location.href;if(this.useReferrer)$.merge(terms,this.termsFromReferrer().split(/\s+/));if(this.useLocation)$.merge(terms,this.queryStringValue(uri,this.searchKey).split(/\s+/));return terms;}};makeSearchKey=function(key){return(typeof key==='string')?new RegExp('^'+key+'=(.*)$','i'):key;};makeAddress=function(addr){return(typeof addr==='string')?new RegExp('^https?://(www\\.)?'+addr,'i'):addr;};$.fn.highlightSearchTerms=function(options){options=$.extend({},defaults,options);options=$.extend(options,{searchKey:makeSearchKey(options.searchKey),referrers:$.map(options.referrers,function(se){return{address:makeAddress(se.address),key:makeSearchKey(se.key)};})});if(options.includeOwnDomain){var hostname=$.fn.highlightSearchTerms._test_location!==null?$.fn.highlightSearchTerms._test_location:location.hostname;options.referrers.push({address:makeAddress(hostname.replace(/\./g,'\\.')),key:options.searchKey});}new Highlighter(options).highlight(this);return this;};$.fn.highlightSearchTerms.referrers=[{address:'google\\.',key:'q'},{address:'search\\.yahoo\\.',key:'p'},{address:'search\\.msn\\.',key:'q'},{address:'search\\.live\\.',key:'query'},{address:'search\\.aol\\.',key:'userQuery'},{address:'ask\\.com',key:'q'},{address:'altavista\\.',key:'q'},{address:'feedster\\.',key:'q'}];defaults={terms:[],useLocation:true,searchKey:'(searchterm|SearchableText)',useReferrer:true,referrers:$.fn.highlightSearchTerms.referrers,includeOwnDomain:true,caseInsensitive:true,filterTerms:/(not|and|or)/i,highlightClass:'highlightedSearchTerm'};$.fn.highlightSearchTerms._test_location=null;$.fn.highlightSearchTerms._test_referrer=null;$.fn.highlightSearchTerms._highlighter=Highlighter;}(jQuery));jQuery(function($){$('#region-content,#content').highlightSearchTerms({includeOwnDomain:$('dl.searchResults').length===0});});
/* resource: ++resource++plone.app.event/event.js */
if(require===undefined)require=function(reqs,torun){'use strict';return torun(window.jQuery);};require(['jquery'],function($){'use strict';var end_start_delta=1/24;function a_or_b(a,b){var ret;if(a.length>0)ret=a;else ret=b;return ret;}function getDateTime(datetimewidget){var date,time,datetime;date=$('input[name="_submit"]:first',datetimewidget).prop('value');date=date.split("-");time=$('input[name="_submit"]:last',datetimewidget).prop('value')||'00:00';time=time.split(":");datetime=new Date(parseInt(date[0],10),parseInt(date[1],10)-1,parseInt(date[2],10),parseInt(time[0],10),parseInt(time[1],10));return datetime;}function initDelta(){var start_datetime,end_datetime;start_datetime=getDateTime(a_or_b($('#formfield-form-widgets-IEventBasic-start'),$('#archetypes-fieldname-startDate')));end_datetime=getDateTime(a_or_b($('#formfield-form-widgets-IEventBasic-end'),$('#archetypes-fieldname-endDate')));end_start_delta=(end_datetime-start_datetime)/1000/60;}function updateEndDate(){var jq_start,jq_end,start_date,new_end_date;jq_start=a_or_b($('#formfield-form-widgets-IEventBasic-start'),$('#archetypes-fieldname-startDate'));jq_end=a_or_b($('#formfield-form-widgets-IEventBasic-end'),$('#archetypes-fieldname-endDate'));start_date=getDateTime(jq_start);new_end_date=new Date(start_date);new_end_date.setMinutes(start_date.getMinutes()+end_start_delta);$('.pattern-pickadate-date',jq_end).pickadate('picker').set('select',new_end_date);$('.pattern-pickadate-time',jq_end).pickatime('picker').set('select',new_end_date);}function validateEndDate(){var jq_start,jq_end,start_datetime,end_datetime;jq_start=a_or_b($('#formfield-form-widgets-IEventBasic-start'),$('#archetypes-fieldname-startDate'));jq_end=a_or_b($('#formfield-form-widgets-IEventBasic-end'),$('#archetypes-fieldname-endDate'));start_datetime=getDateTime(jq_start);end_datetime=getDateTime(jq_end);if(end_datetime<start_datetime)jq_end.addClass("error");else jq_end.removeClass("error");}function show_hide_widget(widget,hide,fade){var $widget=$(widget);if(hide===true)if(fade===true)$widget.fadeOut();else $widget.hide();else if(fade===true)$widget.fadeIn();else $widget.show();}function event_listing_calendar_init(cal){if($().dateinput&&cal.length>0){var get_req_param,val;get_req_param=function(name){if(name===new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)').exec(window.location.search))return decodeURIComponent(name[1]);};val=get_req_param('date');if(val===undefined)val=new Date();else val=new Date(val);cal.dateinput({selectors:true,trigger:true,format:'yyyy-mm-dd',yearRange:[-10,10],firstDay:1,value:val,change:function(){var value=this.getValue("yyyy-mm-dd");window.location.href='event_listing?mode=day&date='+value;}}).unbind('change').bind('onShow',function(){var trigger_offset=$(this).next().offset();$(this).data('dateinput').getCalendar().offset({top:trigger_offset.top+20,left:trigger_offset.left});});}}function initilize_event(){var jq_whole_day,jq_time,jq_open_end,jq_end,jq_start;jq_whole_day=a_or_b($('#formfield-form-widgets-IEventBasic-whole_day input'),$('form[name="edit_form"] input#wholeDay'));jq_time=a_or_b($('#formfield-form-widgets-IEventBasic-start .pattern-pickadate-time-wrapper, #formfield-form-widgets-IEventBasic-end .pattern-pickadate-time-wrapper'),$('#archetypes-fieldname-startDate .pattern-pickadate-time-wrapper, #archetypes-fieldname-endDate .pattern-pickadate-time-wrapper'));if(jq_whole_day.length>0){jq_whole_day.bind('change',function(e){show_hide_widget(jq_time,e.target.checked,true);});show_hide_widget(jq_time,jq_whole_day.get(0).checked,false);}jq_open_end=a_or_b($('#formfield-form-widgets-IEventBasic-open_end input'),$('form[name="edit_form"] input#openEnd'));jq_end=a_or_b($('#formfield-form-widgets-IEventBasic-end'),$('#archetypes-fieldname-endDate'));if(jq_open_end.length>0){jq_open_end.bind('change',function(e){show_hide_widget(jq_end,e.target.checked,true);});show_hide_widget(jq_end,jq_open_end.get(0).checked,false);}jq_start=a_or_b($('#formfield-form-widgets-IEventBasic-start'),$('#archetypes-fieldname-startDate'));jq_start.each(function(){$(this).on('focus','.picker__input',initDelta);$(this).on('change','.picker__input',updateEndDate);});jq_end.each(function(){$(this).on('focus','.picker__input',initDelta);$(this).on('change','.picker__input',validateEndDate);});event_listing_calendar_init($("#event_listing_calendar"));};var interval=setInterval(function(){if($(document.body).hasClass('patterns-loaded')){clearInterval(interval);initilize_event();}},100);});
}catch(e){
    // log it
    if (typeof console !== "undefined"){
        console.log('Error loading javascripts!' + e);
    }
}finally{
    define = _old_define;
    require = _old_require;
}
