<IfModule !mod_proxy>
  Error "mod_proxy is required by {{ DF_PROJECT_NAME }}.  Load it with LoadModule."
</IfModule>
{% if WEBSOCKET_URL %}<IfModule !mod_proxy_wstunnel>
  Error "mod_proxy_wstunnel is required by {{ DF_PROJECT_NAME }}.  Load it with LoadModule."
</IfModule>
{% endif %}<IfModule !mod_proxy_http>
  Error "mod_proxy_http is required by {{ DF_PROJECT_NAME }}.  Load it with LoadModule."
</IfModule>
<IfModule !mod_headers>
  Error "mod_headers is required by {{ DF_PROJECT_NAME }}.  Load it with LoadModule."
</IfModule>
{% if USE_SSL %}<IfModule !mod_ssl>
  Error "mod_ssl is required by {{ DF_PROJECT_NAME }}.  Load it with LoadModule."
</IfModule>
{% endif %}{% if USE_X_SEND_FILE %}<IfModule !mod_xsendfile>
  Error "mod_xsendfile is required by {{ DF_PROJECT_NAME }}.  Load it with LoadModule."
</IfModule>
{% endif %}
<VirtualHost *:{{ SERVER_PORT }}>
    ServerName          {{ SERVER_NAME }}
    ServerAdmin {{ DEFAULT_FROM_EMAIL }}
    Alias               {{ STATIC_URL }}    {{ STATIC_ROOT }}
    Alias               {{ MEDIA_URL }}     {{ MEDIA_ROOT }}
    ProxyPass           {{ STATIC_URL }}    !
    ProxyPass           {{ MEDIA_URL }}     !
{% if WEBSOCKET_URL %}    ProxyPass           {{ WEBSOCKET_URL }} wss://{{ LISTEN_ADDRESS }}/
{% endif %}    ProxyPass           /           http://{{ LISTEN_ADDRESS }}/
    ProxyPassReverse    /           http://{{ LISTEN_ADDRESS }}/
    DocumentRoot        {{ STATIC_ROOT }}
    ServerSignature     off
    <Location {{ STATIC_URL }}>
        Require all granted
    </Location>
    <Location {{ URL_PREFIX }}>
    	{% if USE_HTTP_BASIC_AUTH %}AuthType basic
        AuthName "{{ DF_PROJECT_NAME }}"
        Require valid-user
    	{% endif %}
        ProxyAddHeaders On
        {% if USE_SSL %}RequestHeader set X-Forwarded-Proto 'https' env=HTTPS
        {% endif %}{% if USE_X_SEND_FILE %}
        {% endif %}
    </Location>

</VirtualHost>
