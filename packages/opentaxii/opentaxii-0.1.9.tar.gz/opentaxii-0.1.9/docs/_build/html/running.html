
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Running OpenTAXII &#8212; OpenTAXII 0.1.9 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Docker" href="docker.html" />
    <link rel="prev" title="Configuration" href="configuration.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="running-opentaxii">
<h1>Running OpenTAXII<a class="headerlink" href="#running-opentaxii" title="Permalink to this headline">¶</a></h1>
<p>Here we describe how to run OpenTAXII in a <em>development</em> or <em>production</em> mode. Development mode activates <a class="reference external" href="http://flask.pocoo.org/">Flask</a> debug mode, simplifies log messages (for humans) and runs the server in one thread. While in production mode there are no debug messages, proper json log messages and multithreaded if configured.</p>
<div class="section" id="development-mode">
<h2>Development mode<a class="headerlink" href="#development-mode" title="Permalink to this headline">¶</a></h2>
<p>To run the server in development mode use the CLI command shipped with OpenTAXII package:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ opentaxii-run-dev
</pre></div>
</div>
<p>This will start OpenTAXII in a development mode and bind it to <code class="docutils literal"><span class="pre">localhost:9000</span></code>.</p>
</div>
<div class="section" id="production-mode">
<h2>Production mode<a class="headerlink" href="#production-mode" title="Permalink to this headline">¶</a></h2>
<p>To run OpenTAXII in production it is recommended to use one of the <a class="reference external" href="http://flask.pocoo.org/docs/0.10/deploying/wsgi-standalone/">standalone WSGI
containers</a> that work with Flask. In this example we use <a class="reference external" href="http://gunicorn.org/">Gunicorn WSGI HTTP Server</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Run <cite>pip install gunicorn</cite> to install gunicorn. Yes it’s that simple.</p>
</div>
<p>To run OpenTAXII with Gunicorn execute:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ gunicorn opentaxii.http:app --bind localhost:9000
</pre></div>
</div>
<p>Common practice is to wrap gunicorn execution into <a class="reference external" href="http://supervisord.org">supervisord</a>, to be able to monitor, start, and stop it easily.</p>
<p>Example supervisord configuration file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[program:opentaxii]</span>

<span class="na">command</span> <span class="o">=</span><span class="s"></span>
<span class="s">    /opt/eclecticiq/opentaxii-venv/bin/gunicorn opentaxii.http:app</span>
<span class="s">        --workers 2</span>
<span class="s">        --log-level info</span>
<span class="s">        --log-file -</span>
<span class="s">        --timeout 300</span>
<span class="s">        --bind localhost:9000</span>
<span class="na">environment</span> <span class="o">=</span><span class="s"></span>
<span class="s">    OPENTAXII_CONFIG=&quot;/opt/eclecticiq/custom-opentaxii-configuration.yml&quot;</span>

<span class="na">stdout_logfile</span> <span class="o">=</span> <span class="s">/var/log/opentaxii.log</span>
<span class="na">redirect_stderr</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">autostart</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">autorestart</span> <span class="o">=</span> <span class="s">true</span>
</pre></div>
</div>
</div>
<div class="section" id="sending-requests-to-services">
<h2>Sending requests to services<a class="headerlink" href="#sending-requests-to-services" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to send requests to TAXII services is to use <a class="reference external" href="http://github.com/eclecticiq/cabby">Cabby library</a> CLI tools:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ pip install cabby
</pre></div>
</div>
<p>If you are running OpenTAXII in default configuration and you created services using <a class="reference internal" href="configuration.html"><span class="doc">provided examples</span></a>, you should
be able to communicate with the services.</p>
<p>Assuming OpenTAXII is running on <code class="docutils literal"><span class="pre">http://localhost:9000</span></code>, to get the list of advertised services, run:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ taxii-discovery --path http://localhost:9000/services/discovery-a
</pre></div>
</div>
<p>You should see the following output:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="m">2015</span>-04-03 <span class="m">13</span>:51:35,726 INFO: Sending Discovery_Request to http://localhost:9000/services/discovery-a
<span class="o">{</span><span class="s2">&quot;level&quot;</span>: <span class="s2">&quot;info&quot;</span>, <span class="s2">&quot;timestamp&quot;</span>: <span class="s2">&quot;2015-04-03T11:51:35.788228Z&quot;</span>, <span class="s2">&quot;event&quot;</span>: <span class="s2">&quot;Processing message&quot;</span>, <span class="s2">&quot;message_version&quot;</span>: <span class="s2">&quot;urn:taxii.mitre.org:message:xml:1.1&quot;</span>, <span class="s2">&quot;service_id&quot;</span>: <span class="s2">&quot;discovery_a&quot;</span>, <span class="s2">&quot;logger&quot;</span>: <span class="s2">&quot;opentaxii.taxii.services.discovery.DiscoveryService&quot;</span>, <span class="s2">&quot;message_type&quot;</span>: <span class="s2">&quot;Discovery_Request&quot;</span>, <span class="s2">&quot;message_id&quot;</span>: <span class="s2">&quot;8b7d6fb8-7c74-46d5-a74f-71a9662f3cd9&quot;</span><span class="o">}</span>
<span class="m">2015</span>-04-03 <span class="m">13</span>:51:35,793 INFO: Response received <span class="k">for</span> Discovery_Request from http://localhost:9000/services/discovery-a
<span class="m">2015</span>-04-03 <span class="m">13</span>:51:35,793 INFO: <span class="m">7</span> services <span class="nv">discovered</span>
<span class="o">===</span> Service <span class="nv">Instance</span> <span class="o">===</span>
  Service Type: INBOX
  Service Version: urn:taxii.mitre.org:services:1.1
  Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
  Service Address: http://localhost:9000/services/inbox-a
  Message Binding: urn:taxii.mitre.org:message:xml:1.0
  Message Binding: urn:taxii.mitre.org:message:xml:1.1
  Inbox Service AC: <span class="o">[]</span>
  Available: True
  Message: Custom Inbox Service Description <span class="nv">A</span>

<span class="o">===</span> Service <span class="nv">Instance</span> <span class="o">===</span>
  Service Type: INBOX
  Service Version: urn:taxii.mitre.org:services:1.1
  Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
  Service Address: http://localhost:9000/services/inbox-b
  Message Binding: urn:taxii.mitre.org:message:xml:1.0
  Message Binding: urn:taxii.mitre.org:message:xml:1.1
  Inbox Service AC: <span class="o">[</span><span class="s1">&#39;urn:stix.mitre.org:xml:1.1.1&#39;</span>, <span class="s1">&#39;urn:custom.example.com:json:0.0.1&#39;</span><span class="o">]</span>
  Available: True
  Message: Custom Inbox Service Description <span class="nv">B</span>

<span class="o">===</span> Service <span class="nv">Instance</span> <span class="o">===</span>
  Service Type: DISCOVERY
  Service Version: urn:taxii.mitre.org:services:1.1
  Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
  Service Address: http://localhost:9000/services/discovery-a
  Message Binding: urn:taxii.mitre.org:message:xml:1.0
  Message Binding: urn:taxii.mitre.org:message:xml:1.1
  Available: True
  Message: Custom Discovery Service description
..... snip .....
</pre></div>
</div>
<p>One of the configured services is a Collection Management Service. To get the collections list, run:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="o">(</span>venv<span class="o">)</span> $ taxii-collections --path http://localhost:9000/services/collection-management-a
</pre></div>
</div>
<p>You should see the following output:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="m">2015</span>-04-03 <span class="m">13</span>:53:50,516 INFO: Sending Collection_Information_Request to http://localhost:9000/services/collection-management-a
<span class="o">{</span><span class="s2">&quot;level&quot;</span>: <span class="s2">&quot;info&quot;</span>, <span class="s2">&quot;timestamp&quot;</span>: <span class="s2">&quot;2015-04-03T11:53:50.526007Z&quot;</span>, <span class="s2">&quot;event&quot;</span>: <span class="s2">&quot;Processing message&quot;</span>, <span class="s2">&quot;message_version&quot;</span>: <span class="s2">&quot;urn:taxii.mitre.org:message:xml:1.1&quot;</span>, <span class="s2">&quot;service_id&quot;</span>: <span class="s2">&quot;collection_management_a&quot;</span>, <span class="s2">&quot;logger&quot;</span>: <span class="s2">&quot;opentaxii.taxii.services.collection_management.CollectionManagementService&quot;</span>, <span class="s2">&quot;message_type&quot;</span>: <span class="s2">&quot;Collection_Information_Request&quot;</span>, <span class="s2">&quot;message_id&quot;</span>: <span class="s2">&quot;cf1fed62-51bb-470c-a4f1-52b512df7f10&quot;</span><span class="o">}</span>
<span class="m">2015</span>-04-03 <span class="m">13</span>:53:50,599 INFO: Response received <span class="k">for</span> Collection_Information_Request from http://localhost:9000/services/collection-management-a
<span class="o">===</span> Data Collection <span class="nv">Information</span> <span class="o">===</span>
  Collection Name: collection-A
  Collection Type: DATA_SET
  Available: True
  Collection Description: None
  Supported Content: <span class="nv">All</span>
  <span class="o">===</span> Polling Service <span class="nv">Instance</span> <span class="o">===</span>
        Poll Protocol: urn:taxii.mitre.org:protocol:http:1.0
        Poll Address: http://localhost:9000/services/poll-a
        Message Binding: urn:taxii.mitre.org:message:xml:1.0
        Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Subscription <span class="nv">Service</span> <span class="o">===</span>
        Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
        Address: http://localhost:9000/services/collection-management-a
        Message Binding: urn:taxii.mitre.org:message:xml:1.0
        Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Subscription <span class="nv">Service</span> <span class="o">===</span>
        Protocol Binding: urn:taxii.mitre.org:protocol:https:1.0
        Address: https://localhost:9000/services/collection-management-a
        Message Binding: urn:taxii.mitre.org:message:xml:1.0
        Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Receiving Inbox <span class="nv">Service</span> <span class="o">===</span>
        Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
        Address: http://localhost:9000/services/inbox-a
        Message Binding: urn:taxii.mitre.org:message:xml:1.0
        Message Binding: urn:taxii.mitre.org:message:xml:1.1
        Supported Contents: <span class="nv">All</span>
<span class="o">==================================</span>


<span class="o">===</span> Data Collection <span class="nv">Information</span> <span class="o">===</span>
  Collection Name: collection-B
  Collection Type: DATA_FEED
  Available: True
  Collection Description: None
  Supported Content:   urn:stix.mitre.org:xml:1.1.1
  <span class="o">===</span> Polling Service <span class="nv">Instance</span> <span class="o">===</span>
        Poll Protocol: urn:taxii.mitre.org:protocol:http:1.0
        Poll Address: http://localhost:9000/services/poll-a
        Message Binding: urn:taxii.mitre.org:message:xml:1.0
        Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Subscription <span class="nv">Service</span> <span class="o">===</span>
        Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
        Address: http://localhost:9000/services/collection-management-a
        Message Binding: urn:taxii.mitre.org:message:xml:1.0
        Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Subscription <span class="nv">Service</span> <span class="o">===</span>
        Protocol Binding: urn:taxii.mitre.org:protocol:https:1.0
        Address: https://localhost:9000/services/collection-management-a
        Message Binding: urn:taxii.mitre.org:message:xml:1.0
        Message Binding: urn:taxii.mitre.org:message:xml:1.1
  <span class="o">===</span> Receiving Inbox <span class="nv">Service</span> <span class="o">===</span>
        Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
        Address: http://localhost:9000/services/inbox-a
        Message Binding: urn:taxii.mitre.org:message:xml:1.0
        Message Binding: urn:taxii.mitre.org:message:xml:1.1
        Supported Contents: <span class="nv">All</span>
  <span class="o">===</span> Receiving Inbox <span class="nv">Service</span> <span class="o">===</span>
        Protocol Binding: urn:taxii.mitre.org:protocol:http:1.0
        Address: http://localhost:9000/services/inbox-b
        Message Binding: urn:taxii.mitre.org:message:xml:1.0
        Message Binding: urn:taxii.mitre.org:message:xml:1.1
        Supported Content: urn:stix.mitre.org:xml:1.1.1
        Supported Content: urn:custom.example.com:json:0.0.1
<span class="o">==================================</span>

.... snip .....
</pre></div>
</div>
<p>See <a class="reference external" href="http://cabby.readthedocs.org">Cabby documentation</a> for more examples.</p>
</div>
<div class="section" id="health-check">
<h2>Health check<a class="headerlink" href="#health-check" title="Permalink to this headline">¶</a></h2>
<p>OpenTAXII has an endpoint that can be used to check health of the service:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span>$ curl http://localhost:9000/management/health
<span class="o">{</span>
  <span class="s2">&quot;alive&quot;</span>: <span class="nb">true</span>
<span class="o">}</span>
</pre></div>
</div>
<p class="rubric">Next steps</p>
<p>Continue to <a class="reference internal" href="auth.html"><span class="doc">Authentication</span></a> page to learn how OpenTAXII authentication process works.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Running OpenTAXII</a><ul>
<li><a class="reference internal" href="#development-mode">Development mode</a></li>
<li><a class="reference internal" href="#production-mode">Production mode</a></li>
<li><a class="reference internal" href="#sending-requests-to-services">Sending requests to services</a></li>
<li><a class="reference internal" href="#health-check">Health check</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="configuration.html" title="previous chapter">Configuration</a></li>
      <li>Next: <a href="docker.html" title="next chapter">Docker</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, EclecticIQ.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>